{
    "projects":
    [
        {
            "name":"TestGame1",
            "resource_path":"game1",
            "project_path":"game1",
            "need_copy":true,
            "crypt":{
                "key":"helloworld",
                "type":"md5",
                "with_ext":false
            },
            "xcode_project_path":"frameworks/runtime-src/proj.ios_mac",
            "target_name":"TestGame1",
            "package_id":"com.uuzu.testgame1",
            "display_name":"Hello1",
            "xxtea_key":"newkey",
            "xxtea_sign":"XXTEAXX"
        }
    ],
    
    "steps":[
        {
            "name":"just a test",
            "actions":[
                {
                    "name":"copy_files",
                    "from":"${GLOBAL_DATA_DIR}/cpp/cocos2d-x",
                    "to":"frameworks/cocos2d-x"
                },
                {
                    "name":"modify_files",
                    "files":[
                        {
                            "operation":"insert",
                            "file_path":"frameworks/cocos2d-x/cocos/platform/CCFileUtils.h",
                            "keys":["virtual bool isDirectoryExistInternal(const std::string& dirPath) const;"],
                            "words":"\n\n    std::string getObfuscatePath(const std::string& filepath) const;"
                        },
                        {
                            "operation":"insert_before",
                            "file_path":"frameworks/cocos2d-x/cocos/platform/CCFileUtils.cpp",
                            "keys":["std::string FileUtils::getPathForFilename"],
                            "words_file":"${GLOBAL_DATA_DIR}/obf1.txt"
                        },
                        {
                            "operation":"insert",
                            "file_path":"frameworks/cocos2d-x/cocos/platform/CCFileUtils.cpp",
                            "keys":["std::string FileUtils::getPathForFilename","getFullPathForDirectoryAndFilename(path, file);"],
                            "words_file":"${GLOBAL_DATA_DIR}/obf2.txt"
                        },
                        {
                            "operation":"insert_before",
                            "file_path":"frameworks/cocos2d-x/cocos/platform/CCFileUtils.cpp",
                            "keys":["#include \"tinyxml2/tinyxml2.h\""],
                            "words":"\n#include \"platform/CCFileCrypt.h\"\n"
                        },
                        {
                            "operation":"insert",
                            "file_path":"frameworks/cocos2d-x/cocos/platform/CCFileUtils.cpp",
                            "keys":["NS_CC_END"],
                            "words":"\n#include \"platform/CCFileCrypt.cpp\"\n"
                        },
                        {
                            "operation":"insert",
                            "file_path":"frameworks/runtime-src/Classes/AppDelegate.cpp",
                            "keys":["#include \"cocos2d.h\""],
                            "words":"\n#include \"platform/CCFileCrypt.h\"\n"
                        },                
                        {
                            "operation":"replace_after",
                            "file_path":"frameworks/runtime-src/Classes/AppDelegate.cpp",
                            "froms":["register_all_packages();"],
                            "tos":["));"],
                            "words":"\nFileCrypt::getInstance()->setXXTEAKeyAndSign(\"${PROJECT_XXTEA_KEY}\", strlen(\"${PROJECT_XXTEA_KEY}\"), \"${PROJECT_XXTEA_SIGN}\", strlen(\"${PROJECT_XXTEA_SIGN}\"));\n"
                        }                
                    ]
                },
                {
                    "name":"crypt_files",
                    "from":"res",
                    "key":"${PROJECT_XXTEA_KEY}",
                    "sign":"${PROJECT_XXTEA_SIGN}",
                    "include":["*.png"]
                },
                {
                    "name":"set_xcode_project"
                },
                {
                    "name":"copy_files",
                    "from":"icons",
                    "to":"frameworks/runtime-src/proj.ios_mac/ios/Images.xcassets/AppIcon.appiconset"
                },
                {
                    "name":"obfuscate_resources",
                    "res_path":"res",
                    "sub_dirs":["cocosbuilderRes","hd","ccs-res","ccs-res/hd"],
                    "remove_source":true
                },
                {
                    "name":"obfuscate_resources",
                    "res_path":"src",
                    "remove_source":false
                }
            ]
        },
        {
            "name":"test generate",
            "actions":[
                {
                    "name":"generate_code",
                    "out_dir":"${PROJECT_XCODE_PROJECT_PATH}/generate",
                    "tpl_dir":"${GLOBAL_DATA_DIR}/template",
                    "xcode_project_path":"${PROJECT_XCODE_PROJECT_PATH}",
                    "max_generate_file_count":20,
                    "min_generate_file_count":10,
                    "generate_field_count":4,
                    "generate_method_count":5,
                    "parameter_count":3,
                    "exec_code_file_path":"frameworks/runtime-src/Classes/AppDelegate.cpp",
                    "include_insert_keys":["#include \"cocos2d.h\""],
                    "code_insert_keys":["AppDelegate::~AppDelegate()","{"]
                },
                {
                    "name":"inject_code",
                    "probability":20,
                    "files":["frameworks/cocos2d-x/cocos"],
                    "tpl_dir":"${GLOBAL_DATA_DIR}/template",
                    "generate_field_count":4,
                    "generate_method_count":5,
                    "parameter_count":3
                }
            ]
        }
    ]
}